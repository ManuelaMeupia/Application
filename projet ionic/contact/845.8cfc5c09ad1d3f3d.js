"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[845],{845:(f,d,a)=>{a.r(d),a.d(d,{ContactPage:()=>C});var p=a(467),i=a(4341),h=a(177),u=a(1626),t=a(3953),g=a(8986),m=a(791);function _(s,l){if(1&s&&(t.j41(0,"li")(1,"h2"),t.EFF(2),t.k0s(),t.j41(3,"p"),t.EFF(4),t.k0s()()),2&s){const c=l.$implicit;t.R7$(2),t.JRh(c.Nom),t.R7$(2),t.JRh(c.Telephone)}}let C=(()=>{var s;class l{constructor(e,o,n){this.http=e,this.route=o,this.alertCtrl=n,this.searchTerm="",this.contacts=[],this.filteredContacts=[],this.authorName="",this.authorPhone=""}ngOnInit(){this.loadContacts()}loadContacts(){var e=this;return(0,p.A)(function*(){const o=e.route.snapshot.queryParamMap.get("id");if(e.authorName=e.route.snapshot.queryParamMap.get("nom")||"",e.authorPhone=e.route.snapshot.queryParamMap.get("telephone")||"",o)try{const n=yield e.http.get(`http://localhost/api/contact.php?id=${o}`).toPromise();n.success?(e.contacts=n.data,e.filteredContacts=e.contacts):console.error("API error:",n.message)}catch{yield(yield e.alertCtrl.create({header:"Erreur",message:"Erreur lors du chargement des contacts.",buttons:["OK"]})).present()}})()}filterContacts(){const e=this.searchTerm.toLowerCase().trim();this.filteredContacts=this.contacts.filter(o=>o.name.toLowerCase().includes(e)||o.phone.toLowerCase().includes(e))}importContacts(){var e=this;return(0,p.A)(function*(){yield(yield e.alertCtrl.create({header:"Importer Contacts",message:"Fonction d'importation des contacts (CSV) non impl\xe9ment\xe9e.",buttons:["OK"]})).present()})()}exportContacts(){const e=this.prepareCSVContent(),o=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");if(void 0!==n.download){const r=URL.createObjectURL(o);n.setAttribute("href",r),n.setAttribute("download","contacts.csv"),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),this.sendExportedIds()}}prepareCSVContent(){return"Nom,T\xe9l\xe9phone\n"+this.contacts.map(n=>`${n.name},${n.phone}`).join("\n")}sendExportedIds(){var e=this;return(0,p.A)(function*(){const o=e.contacts.map(n=>n.Id_user);if(o.length>0)try{const n={ids:o,author_name:e.authorName,author_phone:e.authorPhone},r=yield e.http.post("http://localhost/api/contact.php",n).toPromise();r.success?console.log("Contacts export\xe9s avec succ\xe8s"):console.error("Erreur API:",r.message)}catch(n){console.error("Erreur lors de l'envoi des IDs export\xe9s:",n),yield(yield e.alertCtrl.create({header:"Erreur",message:"Erreur lors de l'envoi des IDs des contacts.",buttons:["OK"]})).present()}})()}}return(s=l).\u0275fac=function(e){return new(e||s)(t.rXU(u.Qq),t.rXU(g.nX),t.rXU(m.hG))},s.\u0275cmp=t.VBU({type:s,selectors:[["app-contact"]],standalone:!0,features:[t.aNF],decls:18,vars:2,consts:[["lang","en"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"header"],[1,"search-container"],["type","text","placeholder","Rechercher...",3,"ngModelChange","input","ngModel"],[1,"search-icon"],[1,"contacts-list"],[4,"ngFor","ngForOf"],[1,"import-button",3,"click"]],template:function(e,o){1&e&&(t.j41(0,"html",0)(1,"head"),t.nrm(2,"meta",1)(3,"meta",2),t.j41(4,"title"),t.EFF(5,"Annuaire T\xe9l\xe9phonique"),t.k0s()(),t.j41(6,"body")(7,"div",3)(8,"h1"),t.EFF(9,"Annuaire T\xe9l\xe9phonique"),t.k0s()(),t.j41(10,"div",4)(11,"input",5),t.mxI("ngModelChange",function(r){return t.DH7(o.searchTerm,r)||(o.searchTerm=r),r}),t.bIt("input",function(){return o.filterContacts()}),t.k0s(),t.j41(12,"span",6),t.EFF(13,"\u{1f50d}"),t.k0s()(),t.j41(14,"ul",7),t.DNE(15,_,5,2,"li",8),t.k0s(),t.j41(16,"button",9),t.bIt("click",function(){return o.exportContacts()}),t.EFF(17,"Exporter Contacts (CVF)"),t.k0s()()()),2&e&&(t.R7$(11),t.R50("ngModel",o.searchTerm),t.R7$(4),t.Y8G("ngForOf",o.filteredContacts))},dependencies:[h.MD,h.Sq,i.YN,i.me,i.BC,i.vS,u.q1],styles:["body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;margin:0;padding:0}.header[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:10px 20px;text-align:center}.search-container[_ngcontent-%COMP%]{position:relative;margin:20px}.search-container[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%;padding:10px;font-size:16px;border:1px solid #ccc;border-radius:4px}.search-icon[_ngcontent-%COMP%]{position:absolute;top:50%;right:10px;transform:translateY(-50%);color:#007bff}.contacts-list[_ngcontent-%COMP%]{margin:20px;padding:0;list-style-type:none}.contacts-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:10px;border-bottom:1px solid #ccc}.contacts-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px}.contacts-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0 0;color:#666}.import-button[_ngcontent-%COMP%]{display:block;width:calc(100% - 40px);margin:20px auto;padding:10px;background-color:#007bff;color:#fff;border:none;border-radius:4px;font-size:16px;text-align:center;cursor:pointer}.import-button[_ngcontent-%COMP%]:hover{background-color:#0056b3}"]}),l})()}}]);